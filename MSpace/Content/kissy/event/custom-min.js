/*
Copyright 2013, KISSY UI Library v1.40dev
MIT Licensed
build time: Feb 21 21:28
*/
KISSY.add("event/custom/api-impl",function(e,i,d,k){var j=e.trim,f=d._Utils,l=f.splitAndRun;return e.mix(i,{fire:function(c,a,b){var h=void 0,g=i.getTargets(c,1),n=g&&g.length,b=b||{};l(a,function(a){var g,a=f.getTypedGroups(a);g=a[1];a=a[0];g&&(g=f.getGroupsRe(g),b._ks_groups=g);if((g=k.getCustomEvent(c,a))||n){if(g){if(!g.hasObserver()&&(g.bubbles&&!n||!g.bubbles))return}else g=new k({currentTarget:c,type:a});a=g.fire(b);!1!==h&&(h=a)}});return h},publish:function(c,a,b){var h;l(a,function(a){h=
k.getCustomEvent(c,a,1);e.mix(h,b)});return c},addTarget:function(c,a){var b=i.getTargets(c);e.inArray(a,b)||b.push(a);return c},removeTarget:function(c,a){var b=i.getTargets(c),h=e.indexOf(a,b);-1!=h&&b.splice(h,1);return c},getTargets:function(c,a){a||(c["__~ks_bubble_targets"]=c["__~ks_bubble_targets"]||[]);return c["__~ks_bubble_targets"]},on:function(c,a,b,h){a=j(a);f.batchForType(function(a,b,h){b=f.normalizeParam(a,b,h);a=b.type;if(a=k.getCustomEvent(c,a,1))a.on(b)},0,a,b,h);return c},detach:function(c,
a,b,h){a=j(a);f.batchForType(function(a,b,h){var m=f.normalizeParam(a,b,h);(a=m.type)?(a=k.getCustomEvent(c,a,1))&&a.detach(m):(a=k.getCustomEvents(c),e.each(a,function(a){a.detach(m)}))},0,a,b,h);return c}})},{requires:["./api","event/base","./observable"]});KISSY.add("event/custom/api",function(){return{}});
KISSY.add("event/custom",function(e,i,d,k){var j={};e.each(d,function(f,d){j[d]=function(){var c=e.makeArray(arguments);c.unshift(this);return f.apply(null,c)}});d=e.mix({_ObservableCustomEvent:k,Target:j},d);e.mix(i,{Target:j,custom:d});e.EventTarget=j;return d},{requires:["./base","./custom/api-impl","./custom/observable"]});KISSY.add("event/custom/object",function(e,i){function d(i){d.superclass.constructor.call(this);e.mix(this,i)}e.extend(d,i._Object);return d},{requires:["event/base"]});
KISSY.add("event/custom/observable",function(e,i,d,k,j){function f(){f.superclass.constructor.apply(this,arguments);this.defaultFn=null;this.defaultTargetOnly=!1;this.bubbles=!0}var l=j._Utils;e.extend(f,j._ObservableEvent,{constructor:f,on:function(a){a=new d(a);-1==this.findObserver(a)&&this.observers.push(a)},checkMemory:function(){var a=this.currentTarget,b=f.getCustomEvents(a);b&&(this.hasObserver()||delete b[this.type],e.isEmptyObject(b)&&delete a[c])},fire:function(a){var a=a||{},b=this.bubbles,
h=this.currentTarget,g=this.type,c=this.defaultFn,e,d=a,j;a.type=g;d instanceof k||(d.target=h,d=new k(d));d.currentTarget=h;a=this.notify(d);!1!==j&&(j=a);if(b){h=(b=i.getTargets(h,1))&&b.length||0;for(e=0;e<h&&!d.isPropagationStopped();e++)a=i.fire(b[e],g,d),!1!==j&&(j=a)}c&&!d.isDefaultPrevented()&&(g=f.getCustomEvent(d.target,d.type),(!this.defaultTargetOnly&&!g.defaultTargetOnly||this==d.target)&&c.call(this));return j},notify:function(a){var b=this.observers,c,g,d=b.length,e;for(e=0;e<d&&!a.isImmediatePropagationStopped();e++)c=
b[e].notify(a,this),!1!==g&&(g=c),!1===c&&a.halt();return g},detach:function(a){var b,c=a.fn,d=a.context,e=this.currentTarget,f=this.observers,a=a.groups;if(f.length){a&&(b=l.getGroupsRe(a));var j,i,k,o,p=f.length;if(c||b){d=d||e;j=a=0;for(i=[];a<p;++a)if(k=f[a],o=k.context||e,d!=o||c&&c!=k.fn||b&&!k.groups.match(b))i[j++]=k;this.observers=i}else this.reset();this.checkMemory()}}});var c="__~ks_custom_events";f.getCustomEvent=function(a,b,c){var d,e=f.getCustomEvents(a,c);d=e&&e[b];!d&&c&&(d=e[b]=
new f({currentTarget:a,type:b}));return d};f.getCustomEvents=function(a,b){!a[c]&&b&&(a[c]={});return a[c]};return f},{requires:["./api","./observer","./object","event/base"]});KISSY.add("event/custom/observer",function(e,i){function d(){d.superclass.constructor.apply(this,arguments)}e.extend(d,i._Observer,{keys:["fn","context","groups"]});return d},{requires:["event/base"]});
